function Vector(d,c){this.x=d;this.y=c}Vector.prototype={rotate:function(d){var e=this.x;var f=this.y;this.x=Math.cos(d)*e-Math.sin(d)*f;this.y=Math.sin(d)*e+Math.cos(d)*f;return this},mult:function(b){this.x*=b;this.y*=b;return this},clone:function(){return new Vector(this.x,this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},subtract:function(b){this.x-=b.x;this.y-=b.y;return this},set:function(d,c){this.x=d;this.y=c;return this}};function Petal(h,i,g,j,l,k){this.stretchA=h;this.stretchB=i;this.startAngle=g;this.angle=j;this.bloom=k;this.growFactor=l;this.r=1;this.isfinished=false}Petal.prototype={draw:function(){var g=this.bloom.garden.ctx;var h,i,j,f;h=new Vector(0,this.r).rotate(Garden.degrad(this.startAngle));i=h.clone().rotate(Garden.degrad(this.angle));j=h.clone().mult(this.stretchA);f=i.clone().mult(this.stretchB);g.strokeStyle=this.bloom.c;g.beginPath();g.moveTo(h.x,h.y);g.bezierCurveTo(j.x,j.y,f.x,f.y,i.x,i.y);g.stroke()},render:function(){if(this.r<=this.bloom.r){this.r+=this.growFactor;this.draw()}else{this.isfinished=true}}};function Bloom(i,j,h,g,c){this.p=i;this.r=j;this.c=h;this.pc=g;this.petals=[];this.garden=c;this.init();this.garden.addBloom(this)}Bloom.prototype={draw:function(){var f,d=true;this.garden.ctx.save();this.garden.ctx.translate(this.p.x,this.p.y);for(var e=0;e<this.petals.length;e++){f=this.petals[e];f.render();d*=f.isfinished}this.garden.ctx.restore();if(d==true){this.garden.removeBloom(this)}},init:function(){var f=360/this.pc;var d=Garden.randomInt(0,90);for(var e=0;e<this.pc;e++){this.petals.push(new Petal(Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),d+e*f,f,Garden.random(Garden.options.growFactor.min,Garden.options.growFactor.max),this))}}};function Garden(d,c){this.blooms=[];this.element=c;this.ctx=d}Garden.prototype={render:function(){for(var b=0;b<this.blooms.length;b++){this.blooms[b].draw()}},addBloom:function(b){this.blooms.push(b)},removeBloom:function(b){var e;for(var f=0;f<this.blooms.length;f++){e=this.blooms[f];if(e===b){this.blooms.splice(f,1);return this}}},createRandomBloom:function(d,c){this.createBloom(d,c,Garden.randomInt(Garden.options.bloomRadius.min,Garden.options.bloomRadius.max),Garden.randomrgba(Garden.options.color.rmin,Garden.options.color.rmax,Garden.options.color.gmin,Garden.options.color.gmax,Garden.options.color.bmin,Garden.options.color.bmax,Garden.options.color.opacity),Garden.randomInt(Garden.options.petalCount.min,Garden.options.petalCount.max))},createBloom:function(g,h,j,i,c){new Bloom(new Vector(g,h),j,i,c,this)},clear:function(){this.blooms=[];this.ctx.clearRect(0,0,this.element.width,this.element.height)}};Garden.options={petalCount:{min:8,max:15},petalStretch:{min:0.1,max:3},growFactor:{min:0.1,max:1},bloomRadius:{min:8,max:10},density:10,growSpeed:1000/60,color:{rmin:128,rmax:255,gmin:0,gmax:128,bmin:0,bmax:128,opacity:0.1},tanAngle:60};Garden.random=function(c,d){return Math.random()*(d-c)+c};Garden.randomInt=function(c,d){return Math.floor(Math.random()*(d-c+1))+c};Garden.circle=2*Math.PI;Garden.degrad=function(b){return Garden.circle/360*b};Garden.raddeg=function(b){return b/Garden.circle*360};Garden.rgba=function(a,b,h,g){return"rgba("+a+","+b+","+h+","+g+")"};Garden.randomrgba=function(q,a,r,b,g,u,o){var v=Math.round(Garden.random(q,a));var s=Math.round(Garden.random(r,b));var p=Math.round(Garden.random(g,u));var t=5;if(Math.abs(v-s)<=t&&Math.abs(s-p)<=t&&Math.abs(p-v)<=t){return Garden.rgba(q,a,r,b,g,u,o)}else{return Garden.rgba(v,s,p,o)}};